<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenLayer Dispute Resolution</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&family=Courier+Prime:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --cream: #faf8f3;
            --ink: #1a1a1a;
            --rust: #b85842;
            --rust-dim: #8f4434;
            --sage: #5a6c57;
            --shadow: rgba(26, 26, 26, 0.1);
        }

        body {
            font-family: 'Libre Baskerville', serif;
            background: var(--cream);
            color: var(--ink);
            line-height: 1.8;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 3rem 2rem;
        }

        header {
            text-align: center;
            padding: 4rem 0 3rem;
            border-bottom: 3px double var(--rust);
            margin-bottom: 3rem;
        }

        h1 {
            font-size: clamp(2.5rem, 5vw, 4rem);
            font-weight: 700;
            letter-spacing: -0.02em;
            margin-bottom: 0.75rem;
            color: var(--rust);
        }

        .subtitle {
            font-family: 'Courier Prime', monospace;
            font-size: 0.9rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--sage);
        }

        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            border-bottom: 3px solid var(--ink);
        }

        .tab {
            font-family: 'Courier Prime', monospace;
            font-size: 0.85rem;
            padding: 1rem 1.5rem;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            color: var(--sage);
            cursor: pointer;
            transition: all 0.2s;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            margin-bottom: -3px;
        }

        .tab:hover {
            color: var(--rust);
        }

        .tab.active {
            color: var(--rust);
            border-bottom-color: var(--rust);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section {
            background: white;
            border: 2px solid var(--ink);
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 8px 8px 0 var(--shadow);
        }

        h2 {
            font-size: 1.75rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--rust);
            color: var(--rust);
        }

        .form-group {
            margin-bottom: 1.75rem;
        }

        label {
            display: block;
            font-family: 'Courier Prime', monospace;
            font-size: 0.85rem;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            margin-bottom: 0.5rem;
            color: var(--sage);
        }

        input, textarea, select {
            width: 100%;
            padding: 0.875rem;
            font-family: 'Libre Baskerville', serif;
            font-size: 1rem;
            border: 2px solid var(--ink);
            background: var(--cream);
            transition: all 0.3s ease;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            background: white;
            box-shadow: inset 4px 4px 0 var(--shadow);
        }

        textarea {
            resize: vertical;
            min-height: 120px;
            line-height: 1.6;
        }

        button {
            font-family: 'Courier Prime', monospace;
            font-size: 0.9rem;
            font-weight: 700;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            padding: 1rem 2.5rem;
            background: var(--rust);
            color: var(--cream);
            border: 3px solid var(--ink);
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 4px 4px 0 var(--ink);
        }

        button:hover:not(:disabled) {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 var(--ink);
        }

        button:active:not(:disabled) {
            transform: translate(4px, 4px);
            box-shadow: none;
        }

        button:disabled {
            background: #ccc;
            color: #666;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .case-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .case-card {
            background: white;
            border: 2px solid var(--ink);
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .case-card:hover {
            transform: translateY(-4px);
            box-shadow: 6px 6px 0 var(--shadow);
        }

        .case-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--cream);
        }

        .case-id {
            font-family: 'Courier Prime', monospace;
            font-size: 0.85rem;
            color: var(--rust);
            letter-spacing: 0.1em;
        }

        .status-badge {
            font-family: 'Courier Prime', monospace;
            font-size: 0.7rem;
            padding: 0.3rem 0.75rem;
            border: 2px solid var(--ink);
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }

        .status-badge.awaiting_evidence {
            background: var(--cream);
            color: var(--sage);
        }

        .status-badge.ready_for_resolution {
            background: var(--sage);
            color: white;
        }

        .status-badge.resolved {
            background: var(--rust);
            color: white;
        }

        .case-parties {
            margin-bottom: 1rem;
        }

        .party {
            margin-bottom: 0.5rem;
        }

        .party-label {
            font-family: 'Courier Prime', monospace;
            font-size: 0.75rem;
            color: var(--sage);
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }

        .party-name {
            font-size: 1.1rem;
            margin-top: 0.25rem;
        }

        .winner {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--rust);
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 2px solid var(--cream);
        }

        .info {
            font-family: 'Courier Prime', monospace;
            font-size: 0.85rem;
            color: var(--sage);
            padding: 1rem;
            background: rgba(90, 108, 87, 0.1);
            border-left: 3px solid var(--sage);
            margin-top: 1.5rem;
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--sage);
        }

        footer {
            text-align: center;
            padding: 3rem 0 2rem;
            margin-top: 4rem;
            border-top: 3px double var(--rust);
            font-family: 'Courier Prime', monospace;
            font-size: 0.85rem;
            color: var(--sage);
        }

        footer a {
            color: var(--rust);
            text-decoration: none;
            border-bottom: 1px solid var(--rust);
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--cream);
            border-top-color: var(--rust);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(26, 26, 26, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--cream);
            border: 3px solid var(--ink);
            padding: 2.5rem;
            max-width: 700px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 12px 12px 0 rgba(0, 0, 0, 0.3);
        }

        .modal-close {
            float: right;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--rust);
        }

        .reasoning {
            font-style: italic;
            line-height: 1.8;
            padding: 1.5rem;
            background: white;
            border-left: 4px solid var(--rust);
            margin-top: 1.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Dispute Resolution</h1>
            <p class="subtitle">AI Arbitration on GenLayer</p>
        </header>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('create')">Create Case</button>
            <button class="tab" onclick="switchTab('submit')">Submit Evidence</button>
            <button class="tab" onclick="switchTab('resolve')">Resolve</button>
            <button class="tab" onclick="switchTab('cases')">View Cases</button>
        </div>

        <!-- Create Case Tab -->
        <div id="create" class="tab-content active">
            <div class="section">
                <h2>Create New Case</h2>
                <form id="createForm">
                    <div class="form-group">
                        <label for="plaintiff">Plaintiff</label>
                        <input type="text" id="plaintiff" required placeholder="Alice Johnson">
                    </div>
                    <div class="form-group">
                        <label for="defendant">Defendant</label>
                        <input type="text" id="defendant" required placeholder="Bob Smith">
                    </div>
                    <button type="submit">Create Case</button>
                </form>
            </div>
        </div>

        <!-- Submit Evidence Tab -->
        <div id="submit" class="tab-content">
            <div class="section">
                <h2>Submit Evidence</h2>
                <form id="evidenceForm">
                    <div class="form-group">
                        <label for="caseId">Case ID</label>
                        <select id="caseId" required>
                            <option value="">Select a case</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="party">Party</label>
                        <select id="party" required>
                            <option value="plaintiff">Plaintiff</option>
                            <option value="defendant">Defendant</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="evidence">Evidence</label>
                        <textarea id="evidence" required placeholder="Provide detailed evidence supporting your case..."></textarea>
                    </div>
                    <button type="submit">Submit Evidence</button>
                </form>
            </div>
        </div>

        <!-- Resolve Tab -->
        <div id="resolve" class="tab-content">
            <div class="section">
                <h2>Resolve Case</h2>
                <form id="resolveForm">
                    <div class="form-group">
                        <label for="resolveCaseId">Case ID</label>
                        <select id="resolveCaseId" required>
                            <option value="">Select a case</option>
                        </select>
                    </div>
                    <button type="submit">Resolve Case</button>
                    <p class="info">
                        ⚖ AI consensus takes 30-90 seconds as multiple validators with different LLMs independently analyze the evidence and reach agreement.
                    </p>
                </form>
            </div>
        </div>

        <!-- View Cases Tab -->
        <div id="cases" class="tab-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2 style="border: none; padding: 0; margin: 0;">All Cases</h2>
                <button onclick="loadCases()">Refresh</button>
            </div>
            <div id="casesContainer" class="case-grid">
                <div class="empty-state">
                    <p>No cases yet. Create your first case!</p>
                </div>
            </div>
        </div>

        <footer>
            <p>Built on <a href="https://genlayer.com" target="_blank">GenLayer</a></p>
            <p style="margin-top: 0.5rem;">Powered by Optimistic Democracy Consensus</p>
        </footer>
    </div>

    <!-- Modal for case details -->
    <div id="caseModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <div id="modalBody"></div>
        </div>
    </div>

    <script>
        // Mock data storage
        let cases = [];

        // Switch tabs
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');

            if (tabName === 'cases') {
                loadCases();
            } else if (tabName === 'submit' || tabName === 'resolve') {
                updateCaseSelectors();
            }
        }

        // Create case
        document.getElementById('createForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const newCase = {
                case_id: cases.length,
                plaintiff: document.getElementById('plaintiff').value,
                defendant: document.getElementById('defendant').value,
                plaintiff_evidence: "",
                defendant_evidence: "",
                status: "awaiting_evidence",
                winner: "",
                reasoning: ""
            };

            cases.push(newCase);
            alert(`✓ Case #${newCase.case_id} created successfully!`);
            e.target.reset();
            updateCaseSelectors();
        });

        // Submit evidence
        document.getElementById('evidenceForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const caseId = parseInt(document.getElementById('caseId').value);
            const party = document.getElementById('party').value;
            const evidence = document.getElementById('evidence').value;

            if (caseId >= 0 && caseId < cases.length) {
                const caseData = cases[caseId];
                
                if (party === 'plaintiff') {
                    caseData.plaintiff_evidence = evidence;
                } else {
                    caseData.defendant_evidence = evidence;
                }

                if (caseData.plaintiff_evidence && caseData.defendant_evidence) {
                    caseData.status = "ready_for_resolution";
                }

                alert('✓ Evidence submitted!');
                e.target.reset();
            }
        });

        // Resolve case
        document.getElementById('resolveForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const caseId = parseInt(document.getElementById('resolveCaseId').value);
            
            if (caseId >= 0 && caseId < cases.length) {
                const caseData = cases[caseId];

                if (!caseData.plaintiff_evidence || !caseData.defendant_evidence) {
                    alert('Both parties must submit evidence first!');
                    return;
                }

                const btn = e.target.querySelector('button');
                btn.disabled = true;
                btn.innerHTML = '<span class="loading"></span> Analyzing...';

                // Simulate AI analysis
                setTimeout(() => {
                    const decisions = [
                        {
                            winner: "plaintiff",
                            reasoning: "The plaintiff provided documented evidence of the original agreement terms. While scope changes occurred, the defendant failed to formalize these changes and the core deliverables were not met according to the contract."
                        },
                        {
                            winner: "defendant",
                            reasoning: "The evidence demonstrates extensive scope creep without proper change management. The defendant completed the original agreed scope on time, and the additional requirements were not part of the initial contract."
                        }
                    ];

                    const decision = decisions[Math.floor(Math.random() * decisions.length)];
                    
                    caseData.winner = decision.winner;
                    caseData.reasoning = decision.reasoning;
                    caseData.status = "resolved";

                    alert(`✓ Case #${caseId} resolved! Winner: ${decision.winner}`);
                    btn.disabled = false;
                    btn.textContent = 'Resolve Case';
                    loadCases();
                }, 3000);
            }
        });

        // Update case selectors
        function updateCaseSelectors() {
            const selectors = [
                document.getElementById('caseId'),
                document.getElementById('resolveCaseId')
            ];

            selectors.forEach(select => {
                select.innerHTML = '<option value="">Select a case</option>';
                cases.forEach((c, i) => {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `Case #${i}: ${c.plaintiff} vs ${c.defendant}`;
                    select.appendChild(option);
                });
            });
        }

        // Load and display cases
        function loadCases() {
            const container = document.getElementById('casesContainer');
            
            if (cases.length === 0) {
                container.innerHTML = '<div class="empty-state"><p>No cases yet. Create your first case!</p></div>';
                return;
            }

            container.innerHTML = cases.map(c => `
                <div class="case-card" onclick="showCaseDetails(${c.case_id})">
                    <div class="case-header">
                        <span class="case-id">CASE #${c.case_id}</span>
                        <span class="status-badge ${c.status}">${c.status.replace(/_/g, ' ')}</span>
                    </div>
                    <div class="case-parties">
                        <div class="party">
                            <div class="party-label">Plaintiff:</div>
                            <div class="party-name">${c.plaintiff}</div>
                        </div>
                        <div class="party">
                            <div class="party-label">Defendant:</div>
                            <div class="party-name">${c.defendant}</div>
                        </div>
                    </div>
                    ${c.winner ? `<div class="winner">Winner: ${c.winner.charAt(0).toUpperCase() + c.winner.slice(1)}</div>` : ''}
                </div>
            `).join('');
        }

        // Show case details in modal
        function showCaseDetails(caseId) {
            const c = cases[caseId];
            const modalBody = document.getElementById('modalBody');
            
            modalBody.innerHTML = `
                <h2>Case #${c.case_id}</h2>
                <span class="status-badge ${c.status}">${c.status.replace(/_/g, ' ')}</span>
                
                <div style="margin-top: 2rem;">
                    <div class="party" style="margin-bottom: 1.5rem;">
                        <div class="party-label">Plaintiff:</div>
                        <div class="party-name">${c.plaintiff}</div>
                        ${c.plaintiff_evidence ? `<p style="margin-top: 0.75rem; font-size: 0.95rem;">${c.plaintiff_evidence}</p>` : '<p style="margin-top: 0.5rem; color: var(--sage); font-size: 0.9rem;">No evidence submitted</p>'}
                    </div>
                    
                    <div class="party">
                        <div class="party-label">Defendant:</div>
                        <div class="party-name">${c.defendant}</div>
                        ${c.defendant_evidence ? `<p style="margin-top: 0.75rem; font-size: 0.95rem;">${c.defendant_evidence}</p>` : '<p style="margin-top: 0.5rem; color: var(--sage); font-size: 0.9rem;">No evidence submitted</p>'}
                    </div>
                </div>
                
                ${c.winner ? `
                    <div class="winner" style="margin-top: 2rem;">Winner: ${c.winner.charAt(0).toUpperCase() + c.winner.slice(1)}</div>
                    <div class="reasoning">${c.reasoning}</div>
                ` : ''}
            `;
            
            document.getElementById('caseModal').classList.add('active');
        }

        // Close modal
        function closeModal() {
            document.getElementById('caseModal').classList.remove('active');
        }

        // Close modal on outside click
        document.getElementById('caseModal').addEventListener('click', (e) => {
            if (e.target.id === 'caseModal') {
                closeModal();
            }
        });

        // Initial load
        loadCases();
    </script>
</body>
</html>
